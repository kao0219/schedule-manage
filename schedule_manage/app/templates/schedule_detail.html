{% extends 'base.html' %}
{% block content %}
<div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
    <p>{{ selected_date }}</p>
    <div style="width: 36px; height: 36px; background-color: #007bff; color: white;
                display: flex; align-items: center; justify-content: center;
                border-radius: 50%; font-weight: bold;">
      {{ username_initial }} <!-- 予定登録者のアカウント頭文字マーク　-->
    </div>
</div>

<form method="post" enctype="multipart/form-data">
  {% csrf_token %}

  <div class="mb-3">
    <label for="id_schedule_title" class="form-label">タイトル</label>
    {{ form.schedule_title }}
  </div>

  <div class="mb-3">
    <label for="id_schedule_memo" class="form-label">メモ</label>
    {{ form.schedule_memo }}
  </div>

  <div class="mb-3">
    <label class="form-label">終日</label><br>
    {{ form.is_all_day }}
  </div>

  <div class="mb-3">
    <label for="id_start_time" class="form-label">開始</label>
    {{ form.start_time }}
  </div>

  <div class="mb-3">
    <label for="id_end_time" class="form-label">終了</label>
    {{ form.end_time }}
  </div>

  <div class="mb-3">
    <label class="form-label">繰り返し設定</label><br>
    {{ form.repeat_type }}
  </div>

  <div class="mb-3">
    <label class="form-label">見出しの色設定</label><br>
    {{ form.color }}
  </div>

  <div class="mb-3">
    <label class="form-label">画像</label><br>
    {{ form.image_url }}
  </div>

  <button type="submit" name="action" value="edit" class="btn btn-primary">完了</button>
</form>

<hr>

<!-- コメント一覧 -->
<div class="mb-3">
  {% for comment in comments %}
    <div class="d-flex align-items-center border p-2 mb-2">
      <div style="width: 36px; height: 36px; background-color: #007bff; color: white; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-weight: bold;">
        {{ comment.user.username|slice:":1"|upper }}
      </div>
      <div style="margin-left: 10px;">
        <strong>{{ comment.user.username }}</strong>：{{ comment.content }}
      </div>
    </div>
  {% endfor %}
</div>

<!-- コメント投稿 -->
<form method="post" action="{% url 'app:comment_add' schedule_id=schedule.id %}">
  {% csrf_token %}
  <div class="mb-3">
    <label for="id_content" class="form-label">コメントを入力</label>
    {{ comment_form.content }}
  </div>
  <button type="submit" name="action" value="comment" class="btn btn-secondary">送信</button>
</form>



 
<script>
    document.addEventListener('DOMContentLoaded', function () {
      const isAllDayCheckbox = document.getElementById('id_is_all_day');
      const startTimeInput = document.getElementById('id_start_time');
      const endTimeInput = document.getElementById('id_end_time');
  
      function toggleTimeInputs() {
        const isChecked = isAllDayCheckbox.checked;
        startTimeInput.disabled = isChecked;
        endTimeInput.disabled = isChecked;
      }
  
      // 初期状態もチェックして制御
      toggleTimeInputs();
  
      // チェック切り替え時に制御
      isAllDayCheckbox.addEventListener('change', toggleTimeInputs);
    });
</script>

{% endblock %}